Run splint.
Actually try undeleting.
Look into using alloca.
